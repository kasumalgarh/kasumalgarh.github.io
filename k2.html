<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>KASUMALGARH :: Test Page for Experiments</title>

    <link rel="stylesheet" href="./kcss/styles.css">
    <link rel="stylesheet" href="./kcss/test.css">
    <link href='http://fonts.googleapis.com/css?family=Alegreya+SC:700,400italic' rel='stylesheet' type='text/css' />
    <link href="./kcss/ktree.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript" src="./gsgenius/ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

    <style>
        /* General Body and Footer Styles */
        body { background: #380000; }
        .footer .g1::after { content: ""; display: table; clear: both; }

        /* NEW: Main Navigation Bar Styling */
        #main-navbar {
            background-color: #220000; /* Dark Maroon/Black */
            overflow: hidden;
            text-align: center; /* Center the links */
            margin-top: 10px;
            padding: 10px 0;
            border-top: 1px solid #915D28;
            border-bottom: 2px solid #915D28;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.4);
        }
        .nav-item {
            display: inline-block;
            color: #ffd700; /* Gold text */
            text-align: center;
            padding: 14px 20px;
            text-decoration: none;
            font-size: 1.1em;
            font-weight: bold;
            margin: 0 5px;
            transition: background-color 0.3s, color 0.3s;
            border-radius: 5px;
        }
        .nav-item:hover {
            background-color: #550000; /* Lighter Maroon on hover */
            color: white; /* White text on hover */
        }
        
        /* Sidebar Index CSS (Copied from Vanshavali) */
        #name-index-sidebar {
            position: fixed; top: 100px; right: 50px; width: 200px;
            max-height: 80vh; overflow-y: auto; background-color: #220000;
            color: gold; padding: 15px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            z-index: 1000; border: 1px solid #915D28;
        }
        #name-index-sidebar h2 {
            margin-top: 0; font-size: 1.1em; color: #ffd700; border-bottom: 2px solid #915D28;
            padding-bottom: 5px; margin-bottom: 10px; text-align: center;
        }
        #total-names-count { font-size: 0.8em; font-weight: normal; color: #e6b300; }
        #dynamic-name-list { list-style: none; padding: 0; margin: 0; }
        #dynamic-name-list a {
            color: #E6B300; text-decoration: none; display: flex; 
            justify-content: space-between; align-items: center;
            padding: 2px 5px; font-size: 0.9em; border-radius: 3px; transition: background-color 0.3s;
        }
        #dynamic-name-list a:hover { color: white; background-color: #550000; }
        .active-highlight { background-color: yellow; color: #380000 !important; font-weight: bold; }
        .vanshavali-highlight { background-color: yellow !important; color: #380000 !important; padding: 3px !important; border-radius: 5px; }

        /* Social Icons Styling */
        .social-icon {
            display: inline-block; width: 16px; height: 16px; margin-left: 5px; vertical-align: middle;
            background-size: cover; opacity: 0.7; transition: opacity 0.3s; flex-shrink: 0;
        }
        .social-icon:hover { opacity: 1.0; }
        .fb-icon { background-image: url('./kimgs/fb_icon.png'); }
        .insta-icon { background-image: url('./kimgs/insta_icon.png'); }

        @media (max-width: 1000px) { #name-index-sidebar { display: none; } }
    </style>
    </head>
<body>

<center><img src="./kimgs/kasumalgarh_tital.png" alt="Header Logo" style="WIDTH:AUTO;height:80px;" align="center" border="0"; margin-top:0px; ></center>

<div id="main-navbar">
    <a href="./index.html" class="nav-item">üè† HOME</a>
    <a href="./k_vanshavali.html" class="nav-item">üìú Kasumalgarh-Vanshavali</a>
    <a href="./r_vanshavali.html" class="nav-item">üõ°Ô∏è Rathore-Vanshavali</a>
    <a href="./history_gallery.html" class="nav-item">üñºÔ∏è History & Gallery</a>
    <a href="./contact_us.html" class="nav-item">üìû Contact-us</a>
</div>
<center><img src="./kimgs/dup.png" alt="divider" style="WIDTH:500px;HEIGHT:auto;margin-top:0px;"></center>

<center>
<div id="name-index-sidebar">
    <h2>‡§®‡§æ‡§Æ ‡§∏‡•Ç‡§ö‡•Ä (Index) <span id="total-names-count"></span></h2> 
    <ul id="dynamic-name-list"> 
        </ul>
</div>
<table border="0px" width="auto" cellpadding="0" cellspacing="0" ><tr><td>
    <center><h6 style="margin-top:10px;">Family Tree Test Structure</h6></center>
    
    <ul id="KasumalgarhVanshavali">
        <button id="all">Collapse/Expand All</button>

        <li><a id="test_founder" data-fbid="test.founder.fb" data-instaid="test_founder_insta"><strong>Test Founder Name</strong></a>
            <ul>
                <li><a id="test_son_one">Test Son One</a>
                    <ul>
                        <li><a id="test_grandson_one">Kr. Grandson One</a></li>
                    </ul>
                </li>
                <li><a id="test_son_two" data-fbid="test.son.two.fb">Test Son Two</a>
                    <ul>
                        <li><a id="test_grandson_two">Kr. Grandson Two</a></li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>	
    </td></tr></table>
</center>

<center><img src="./kimgs/ddown.png" alt="divider" style="WIDTH:500px;HEIGHT:;margin-bottom: 0cm;"></center>

<center>
<div class="footer">
    <div class="g1">
        <br> Copyrights &copy 2013-2025&nbsp Test User (Kasumalgarh)
        <br>
        <a href="#" onclick="copyVanshavali(); return false;" id="copyButtonFooter">üìÑ For Admin Only (Copy Code)</a>
    </div>
</div>
</center>

<script type="text/javascript">
    $( document ).ready( function( ) {
        
        // Initial Tree Collapse Logic
        $( '#KasumalgarhVanshavali li' ).each( function() {
            if( $( this ).children( 'ul' ).length > 0 ) {
                $( this ).addClass( 'parent' );¬† ¬† ¬†
            }
        });
        $( '#KasumalgarhVanshavali li.parent > a' ).click( function( ) {
            $( this ).parent().toggleClass( 'active' );
            $( this ).parent().children( 'ul' ).slideToggle( 'fast' );
        });
        $( '#all' ).click( function() {
            $( '#KasumalgarhVanshavali li' ).each( function() {
                $( this ).toggleClass( 'active' );
                $( this ).children( 'ul' ).slideToggle( 'fast' );
            });
        });
        $( '#KasumalgarhVanshavali li' ).each( function() {
            $( this ).toggleClass( 'active' );
            $( this ).children( 'ul' ).slideToggle( 'fast' );
        });
        
        // --- Index Generation and Click Handling ---
        
        generateIndex();

        $('#dynamic-name-list').on('click', 'a', function(e) {
            // Social icon ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§® ‡§ï‡§∞‡•á‡§Ç
            if ($(e.target).hasClass('social-icon')) {
                return; 
            }
            
            e.preventDefault();
            var targetId = $(this).attr('href').substring(1);
            // Pass the anchor element for highlighting
            scrollToName(targetId, this); 
        });

    });
    
    // ***** FUNCTION: Automatically generates the Index, counts names, and adds social icons *****
    function generateIndex() {
        var $vanshavali = $('#KasumalgarhVanshavali');
        var $indexList = $('#dynamic-name-list'); 
        var totalNames = 0;
        
        $indexList.empty(); 
        
        $vanshavali.find('a[id]').each(function() {
            var $nameAnchor = $(this);
            var id = $nameAnchor.attr('id');
            var fbId = $nameAnchor.attr('data-fbid');     
            var instaId = $nameAnchor.attr('data-instaid'); 
            
            var nameText = $nameAnchor.html().trim().replace(/<\/?strong>/g, '');
            
            var socialIcons = '<div class="social-icons-container">'; 
            
            if (fbId) {
                socialIcons += '<a href="https://www.facebook.com/' + fbId + '" target="_blank" class="social-icon fb-icon" title="Facebook"></a>';
            }
            if (instaId) {
                var cleanInstaId = instaId.startsWith('@') ? instaId.substring(1) : instaId;
                socialIcons += '<a href="https://www.instagram.com/' + cleanInstaId + '" target="_blank" class="social-icon insta-icon" title="Instagram"></a>';
            }
            socialIcons += '</div>';

            var listItem = '<li><a href="#' + id + '">' + nameText + socialIcons + '</a></li>';
            
            $indexList.append(listItem);
            totalNames++;
        });
        
        $('#total-names-count').text('(' + totalNames + ' ‡§®‡§æ‡§Æ)');
    }
    // ********************************************************************************

    // ***** FUNCTION: Scrolls to the selected name and highlights it *****
    function scrollToName(nameId, indexLinkElement){
        // 1. Remove highlight from all previous elements
        $('.active-highlight').removeClass('active-highlight');
        $('.vanshavali-highlight').removeClass('vanshavali-highlight');

        // 2. Highlight the clicked index link
        $(indexLinkElement).addClass('active-highlight');
        
        // 3. Find the target name in the family tree
        var targetAnchor = document.getElementById(nameId);

        if (targetAnchor) {
            // 4. Highlight the name in the family tree
            $(targetAnchor).addClass('vanshavali-highlight');

            // 5. Scroll to the target
            $('html,body').animate({
                scrollTop: $(targetAnchor).offset().top - 100 
            }, 'slow');
            
            // 6. Remove highlight after a few seconds
            setTimeout(function() {
                $(targetAnchor).removeClass('vanshavali-highlight');
                $(indexLinkElement).removeClass('active-highlight');
            }, 3000); 
        }
    }

    // ***** FUNCTION: Copies Vanshavali Code (For Admin) *****
    function copyVanshavali() {
        const vanshavaliCode = document.getElementById('KasumalgarhVanshavali').outerHTML;
        
        navigator.clipboard.writeText(vanshavaliCode).then(() => {
            alert("‚úÖ ‡§µ‡§Ç‡§∂‡§æ‡§µ‡§≤‡•Ä ‡§ï‡§æ ‡§ï‡•ã‡§° ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ï‡•â‡§™‡•Ä ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à!");
        }).catch(err => {
            console.error('Copy failed:', err);
            alert("‚ùå ‡§ï‡•â‡§™‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§™‡§æ‡§Ø‡§æ‡•§");
        });
    }
</script>

</body>
</html>
