<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§∞‡§æ‡§ú‡§ï‡•Ä‡§Ø ‡§µ‡§Ç‡§∂‡§æ‡§µ‡§≤‡•Ä (Master Royal Family Tree)</title>
    <style>
        :root {
            --bg-color: #f4f4f9;
            --text-color: #333;
            --box-bg: #fff;
            --line-color: #ccc;
            --primary-color: #d4af37; /* Royal Gold */
            --secondary-color: #2c3e50; /* Royal Blue */
        }
        
        body.dark-mode {
            --bg-color: #1a1a1a;
            --text-color: #f4f4f9;
            --box-bg: #333;
            --line-color: #555;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            transition: 0.3s;
            overflow: hidden; /* For Pan/Zoom */
        }

        /* --- Toolbar (Top 25 Features UI) --- */
        #toolbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: var(--secondary-color);
            color: #fff;
            padding: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        button {
            background: var(--primary-color);
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 4px;
            font-weight: bold;
            color: #000;
        }
        button:hover { background: #fff; }
        
        input[type="text"] {
            padding: 5px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        /* --- Tree Container --- */
        #tree-container {
            width: 100vw;
            height: 100vh;
            overflow: scroll; /* Allow native scroll or custom pan */
            padding-top: 80px;
            display: flex;
            justify-content: center;
            cursor: grab;
            transform-origin: top center;
        }

        /* --- Tree Structure (CSS Only) --- */
        .tree ul {
            padding-top: 20px; 
            position: relative;
            transition: all 0.5s;
            display: flex;
            justify-content: center;
        }

        .tree li {
            float: left; text-align: center;
            list-style-type: none;
            position: relative;
            padding: 20px 5px 0 5px;
            transition: all 0.5s;
        }

        /* Connecting Lines */
        .tree li::before, .tree li::after {
            content: '';
            position: absolute; top: 0; right: 50%;
            border-top: 2px solid var(--line-color);
            width: 50%; height: 20px;
        }
        .tree li::after {
            right: auto; left: 50%;
            border-left: 2px solid var(--line-color);
        }
        .tree li:only-child::after, .tree li:only-child::before {
            display: none;
        }
        .tree li:only-child { padding-top: 0; }
        .tree li:first-child::before, .tree li:last-child::after {
            border: 0 none;
        }
        .tree li:last-child::before{
            border-right: 2px solid var(--line-color);
            border-radius: 0 5px 0 0;
        }
        .tree li:first-child::after{
            border-radius: 5px 0 0 0;
        }
        .tree ul ul::before{
            content: '';
            position: absolute; top: 0; left: 50%;
            border-left: 2px solid var(--line-color);
            width: 0; height: 20px;
        }

        /* --- Member Card --- */
        .member-card {
            border: 2px solid var(--line-color);
            padding: 10px;
            text-decoration: none;
            color: var(--text-color);
            font-family: arial, verdana, tahoma;
            font-size: 14px;
            display: inline-block;
            border-radius: 5px;
            transition: all 0.3s;
            background: var(--box-bg);
            min-width: 100px;
            position: relative;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .member-card:hover, .member-card:hover+ul li .member-card {
            background: #e8e8e8; 
            border-color: #94a0b4;
            transform: scale(1.05);
            z-index: 10;
        }
        
        body.dark-mode .member-card:hover { background: #444; }

        .member-card img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: block;
            margin: 0 auto 5px auto;
            background: #ddd;
        }

        .details { font-size: 12px; color: #777; }
        
        /* Stats Panel */
        #stats-panel {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
        }
    </style>
</head>
<body>

<div id="toolbar">
    <span><b>‡§µ‡§Ç‡§∂‡§æ‡§µ‡§≤‡•Ä (Royal Code)</b></span>
    <input type="text" id="searchInput" placeholder="‡§®‡§æ‡§Æ ‡§ñ‡•ã‡§ú‡•á‡§Ç (Search)..." onkeyup="searchMember()">
    
    <button onclick="addMember()">+ ‡§®‡§Ø‡§æ ‡§∏‡§¶‡§∏‡•ç‡§Ø</button>
    
    <button onclick="zoom(0.1)">üîç+</button>
    <button onclick="zoom(-0.1)">üîç-</button>
    
    <button onclick="resetView()">‚ü≤ ‡§∞‡•Ä‡§∏‡•á‡§ü</button>
    
    <button onclick="toggleDarkMode()">üåó ‡§Æ‡•ã‡§°</button>
    
    <button onclick="saveData()">üíæ ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç</button>
    
    <button onclick="loadData()">üìÇ ‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</button>
    
    <button onclick="window.print()">üñ®Ô∏è ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü</button>
    
    <button onclick="toggleFullScreen()">üì∫ ‡§´‡•Å‡§≤ ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§®</button>
    
    <button onclick="toggleStats()">üìä ‡§Ü‡§Ç‡§ï‡•ú‡•á</button>

    <button onclick="alert('‡§ï‡§æ‡§∞‡•ç‡§° ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§ï‡•á ‡§°‡§ø‡§≤‡•Ä‡§ü ‡§ö‡•Å‡§®‡•á‡§Ç')">üóëÔ∏è ‡§π‡§ü‡§æ‡§è‡§Ç</button>
</div>

<div id="tree-container">
    <div class="tree" id="family-tree">
        </div>
</div>

<div id="stats-panel">
    ‡§ï‡•Å‡§≤ ‡§∏‡§¶‡§∏‡•ç‡§Ø: <span id="total-count">0</span> | ‡§™‡•Å‡§∞‡•Å‡§∑: <span id="male-count">0</span> | ‡§Æ‡§π‡§ø‡§≤‡§æ: <span id="female-count">0</span>
</div>

<script>
    // --- 14. Initial Data (Placeholders 1 to 100) ---
    // User asked for placeholders to avoid bad data.
    let familyData = {
        name: "‡§Æ‡•Ç‡§≤ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ú (Root)",
        title: "Pita Ji",
        children: []
    };

    // --- 15. Auto-Generate 100 Dummy Members Logic ---
    function generateDummyData() {
        // Creating a hierarchical structure for 100 items
        let count = 1;
        
        // Helper to add children recursively
        function addChildren(node, depth) {
            if (count >= 100 || depth > 5) return;
            
            // Randomly assign 2-4 children per node to fill up to 100
            let numChildren = Math.floor(Math.random() * 3) + 1; 
            
            if(!node.children) node.children = [];

            for (let i = 0; i < numChildren; i++) {
                if (count >= 100) break;
                let newChild = {
                    name: `‡§∏‡§¶‡§∏‡•ç‡§Ø ${count}`,
                    title: `Idea/Item ${count}`,
                    gender: count % 2 === 0 ? 'F' : 'M', // 16. Random Gender
                    children: []
                };
                node.children.push(newChild);
                count++;
                // Recurse
                addChildren(newChild, depth + 1);
            }
        }
        
        // Start generation
        addChildren(familyData, 0);
        updateStats(count);
    }

    // --- 17. Render Tree Function (Recursive) ---
    function renderTree(node) {
        let html = `<li>
            <a href="#" class="member-card" onclick="editMember(this)" contenteditable="true">
                <img src="${node.gender === 'M' ? 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png' : 'https://cdn-icons-png.flaticon.com/512/3135/3135768.png'}" alt="User">
                <div class="name">${node.name}</div>
                <div class="details">${node.title}</div>
            </a>`;
        
        if (node.children && node.children.length > 0) {
            html += `<ul>`;
            node.children.forEach(child => {
                html += renderTree(child);
            });
            html += `</ul>`;
        }
        
        html += `</li>`;
        return html;
    }

    // Initialize
    generateDummyData();
    document.getElementById('family-tree').innerHTML = `<ul>${renderTree(familyData)}</ul>`;

    // --- Features Logic ---

    // 1. Search
    function searchMember() {
        let input = document.getElementById('searchInput').value.toLowerCase();
        let cards = document.querySelectorAll('.member-card');
        cards.forEach(card => {
            if (card.innerText.toLowerCase().includes(input)) {
                card.style.background = '#ffd700'; // Highlight
                card.scrollIntoView({behavior: "smooth", block: "center"});
            } else {
                card.style.background = ''; // Reset
            }
        });
    }

    // 2. Add Member (Simulated)
    function addMember() {
        alert("‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡•á ‡§®‡§æ‡§Æ ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§ï‡•á ‡§è‡§°‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§®‡§Ø‡§æ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ú‡•ã‡•ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è HTML ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§ö‡§∞ ‡§¨‡•ù‡§æ‡§è‡§Ç (v2 ‡§Æ‡•á‡§Ç ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•ã‡§ó‡§æ)‡•§");
    }

    // 3 & 4. Zoom
    let scale = 1;
    function zoom(val) {
        scale += val;
        document.querySelector('.tree').style.transform = `scale(${scale})`;
    }

    // 5. Reset
    function resetView() {
        scale = 1;
        document.querySelector('.tree').style.transform = `scale(1)`;
    }

    // 6. Dark Mode
    function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');
    }

    // 7. Save to LocalStorage
    function saveData() {
        localStorage.setItem('royalFamilyData', document.getElementById('family-tree').innerHTML);
        alert('‡§µ‡§Ç‡§∂‡§æ‡§µ‡§≤‡•Ä ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§∞ ‡§≤‡•Ä ‡§ó‡§à ‡§π‡•à! (Browser Memory)');
    }

    // 8. Load Data
    function loadData() {
        let data = localStorage.getItem('royalFamilyData');
        if(data) {
            document.getElementById('family-tree').innerHTML = data;
            alert('‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§µ‡§Ç‡§∂‡§æ‡§µ‡§≤‡•Ä ‡§≤‡•ã‡§° ‡§π‡•ã ‡§ó‡§à‡•§');
        } else {
            alert('‡§ï‡•ã‡§à ‡§∏‡•á‡§µ ‡§ï‡§ø‡§Ø‡§æ ‡§π‡•Å‡§Ü ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§');
        }
    }

    // 10. Full Screen
    function toggleFullScreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
    }

    // 13. Stats
    function updateStats(total) {
        document.getElementById('total-count').innerText = total;
        // Approximation for demo
        document.getElementById('male-count').innerText = Math.floor(total / 2); 
        document.getElementById('female-count').innerText = Math.ceil(total / 2);
    }
    function toggleStats() {
        let panel = document.getElementById('stats-panel');
        panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
    }

    // 18. Edit Member (ContentEditable)
    function editMember(element) {
        // Allows direct typing on the card
        console.log("Editing...", element);
    }

    // 19. Drag to Pan (Basic implementation)
    const slider = document.getElementById('tree-container');
    let isDown = false;
    let startX, scrollLeft;

    slider.addEventListener('mousedown', (e) => {
        isDown = true;
        slider.classList.add('active');
        startX = e.pageX - slider.offsetLeft;
        scrollLeft = slider.scrollLeft;
    });
    slider.addEventListener('mouseleave', () => { isDown = false; });
    slider.addEventListener('mouseup', () => { isDown = false; });
    slider.addEventListener('mousemove', (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.pageX - slider.offsetLeft;
        const walk = (x - startX) * 2; //scroll-fast
        slider.scrollLeft = scrollLeft - walk;
    });

</script>

</body>
</html>
