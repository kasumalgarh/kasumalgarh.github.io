<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="utf-8">
    <title>KASUMALGARH :: Super Admin Dashboard</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* ========================================= */
        /* 1. ROYAL THEME BASE */
        /* ========================================= */
        body {
            background-color: #2c0001; /* ‡§ó‡§π‡§∞‡§æ ‡§∂‡§æ‡§π‡•Ä ‡§≤‡§æ‡§≤/‡§Æ‡§∞‡•Ç‡§® */
            color: #f4f4f4;
            font-family: 'Playfair Display', serif;
            text-align: center;
            padding: 0; margin: 0;
            opacity: 0; transition: opacity 0.5s;
        }
        body.visible { opacity: 1; }

        h2, h3, h4 { color: #d4af37; font-family: 'Cinzel', serif; text-transform: uppercase; }
        a { text-decoration: none; color: #d4af37; transition: 0.3s; }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }

        /* ========================================= */
        /* 2. DASHBOARD TOP SECTION */
        /* ========================================= */
        .navbar {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 30px; background: #1a0000; border-bottom: 2px solid #d4af37;
        }
        .logout-btn { color: #ff4444 !important; font-weight: bold; border: 1px solid #ff4444; padding: 5px 15px; border-radius: 20px; }
        .logout-btn:hover { background: #ff4444; color: white !important; }

        .quick-links-grid {
            display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; margin: 30px 0;
        }
        .link-card {
            flex: 1; min-width: 250px; max-width: 300px;
            background: #1a1a1a; border: 1px solid #d4af37; border-radius: 10px; padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        .link-card:hover { transform: translateY(-5px); background: #252525; }
        .action-btn {
            display: block; background: #008000; color: white; padding: 10px; margin-top: 10px;
            border-radius: 5px; font-weight: bold;
        }
        .action-btn:hover { background: #006400; color: white; }

        /* ========================================= */
        /* 3. EDITOR TOOL SECTION (INTEGRATED) */
        /* ========================================= */
        .editor-section {
            border-top: 4px double #d4af37;
            margin-top: 40px;
            padding-top: 30px;
            background: rgba(0, 0, 0, 0.3);
        }
        
        .editor-wrapper { display: flex; gap: 20px; flex-wrap: wrap; text-align: left; }
        
        .editor-panel { 
            flex: 1; min-width: 350px; 
            background-color: rgba(0, 0, 0, 0.8); 
            padding: 25px; border-radius: 10px; border: 2px solid #d4af37; 
        }
        
        .preview-panel { 
            flex: 1; min-width: 350px; 
            background-color: #fdf5e6; 
            color: #333;
            padding: 20px; border-radius: 10px; border: 2px solid #d4af37; 
            max-height: 800px; overflow-y: auto;
        }

        /* Form Inputs */
        input[type="text"], textarea { 
            width: 100%; padding: 10px; margin-bottom: 15px; 
            background-color: #222; color: #fff; 
            border: 1px solid #d4af37; border-radius: 5px; box-sizing: border-box; 
        }
        textarea { min-height: 120px; font-family: monospace; font-size: 0.9em; }
        label { color: #ccc; font-size: 0.9em; display: block; margin-bottom: 5px; }

        /* Tool Buttons */
        .tool-btn {
            background-color: #b38728; color: #000; padding: 10px 20px; border: none;
            border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; margin-bottom: 10px;
        }
        .tool-btn:hover { background-color: #ffd700; }
        .copy-btn { background-color: #008000; color: white; margin-top: 10px; font-size: 1.1em; }

        /* Preview Tree Style (Matches Frontend) */
        .tree ul { list-style: none; padding-left: 20px; margin: 0; border-left: 2px solid #800000; }
        .tree li { padding: 5px 0; position: relative; }
        .member-card {
            border: 2px solid #b38728; padding: 5px 10px; background: #fffbf0; 
            color: #800000; font-weight: bold; display: inline-block; border-radius: 5px;
        }

        /* ========================================= */
        /* 4. STATISTICS */
        /* ========================================= */
        .stats-box { margin-top: 50px; border-top: 1px dashed #555; padding-top: 20px; }
    </style>

    <script>
        // --- PASSWORD PROTECTION ---
        function checkPassword() {
            const CORRECT_PASSWORD = "kasumalgarh2025"; 
            let passwordAttempt = prompt("Admin Panel Access Password:");
            if (passwordAttempt === CORRECT_PASSWORD) {
                document.body.classList.add('visible'); 
            } else {
                alert("Wrong Password!");
                window.location.href = "index.html"; 
            }
        }
    </script>
</head>

<body onload="checkPassword()">

    <nav class="navbar">
        <div style="font-family:'Cinzel'; font-size:1.5em; font-weight:bold; color:#fcf6ba;">
            <i class="fas fa-crown"></i> KASUMALGARH ADMIN
        </div>
        <a href="index.html" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a>
    </nav>

    <div class="container">
        
        <h2>üöÄ Quick Actions</h2>
        <div class="quick-links-grid">
            <div class="link-card">
                <i class="fas fa-envelope-open-text" style="font-size:2em; color:#d4af37;"></i>
                <h4>‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§∏‡§Ç‡§¶‡•á‡§∂</h4>
                <p style="font-size:0.9em; color:#aaa;">‡§¶‡•á‡§ñ‡•á‡§Ç ‡§ï‡§ø ‡§≤‡•ã‡§ó‡•ã‡§Ç ‡§®‡•á ‡§´‡•â‡§∞‡•ç‡§Æ ‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§Ø‡§æ ‡§≠‡§∞‡§æ ‡§π‡•à‡•§</p>
                <a href="https://formsubmit.co/" target="_blank" class="action-btn">Inbox ‡§ñ‡•ã‡§≤‡•á‡§Ç</a>
            </div>
            <div class="link-card">
                <i class="fab fa-github" style="font-size:2em; color:#d4af37;"></i>
                <h4>GitHub ‡§ï‡•ã‡§° (Manual)</h4>
                <p style="font-size:0.9em; color:#aaa;">‡§∏‡•Ä‡§ß‡•á ‡§ï‡•ã‡§° ‡§´‡§æ‡§á‡§≤ ‡§ñ‡•ã‡§≤‡•á‡§Ç ‡§î‡§∞ ‡§è‡§°‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§</p>
                <a href="https://github.com/kasumalgarh/kasumalgarh.github.io/edit/main/vanshawali.html" target="_blank" class="action-btn">Edit on GitHub</a>
            </div>
        </div>

        <div class="editor-section" id="editor-tool">
            <h2>üìù Vanshavali Editor Tool</h2>
            <p style="color:#ccc; margin-bottom: 20px;">‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§∏‡•á ‡§ï‡•ã‡§° ‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§¨‡§ø‡§®‡§æ ‡§ï‡•ã‡§°‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§®‡§æ‡§Æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§</p>

            <div class="editor-wrapper">
                
                <div class="editor-panel">
                    <h3>‡§ö‡§∞‡§£ 1: ‡§ï‡•ã‡§° ‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</h3>
                    
                    <button onclick="fetchLiveCode()" class="tool-btn" style="background:#008080; color:#fff; border:1px solid #fff;">
                        üåê Load Live Code (Auto)
                    </button>
                    <textarea id="inputHtml" placeholder="‡§Ø‡§æ ‡§´‡§ø‡§∞ ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§∏‡•á ‡§ï‡•â‡§™‡•Ä ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§ï‡•ã‡§° ‡§Ø‡§π‡§æ‡§Å ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç..."></textarea>
                    
                    <div style="display:flex; gap:10px;">
                        <button onclick="pasteFromClipboard()" class="tool-btn" style="background:#555; color:#fff;">üìã Paste</button>
                        <button onclick="loadPreview()" class="tool-btn">üîÑ Refresh</button>
                    </div>

                    <hr style="border-color:#555; margin: 20px 0;">

                    <h3>‡§ö‡§∞‡§£ 2: ‡§®‡§Ø‡§æ ‡§®‡§æ‡§Æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h3>
                    <label>‡§¶‡§æ‡§¶‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ (Grandparent Name):</label>
                    <input type="text" id="grandParentName" placeholder="Ex: Th. Ridmal Singh">
                    
                    <label>‡§™‡§ø‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ (Father Name):</label>
                    <input type="text" id="parentName" placeholder="Ex: Th. Bhairu Singh">
                    
                    <label style="color:#d4af37;">‡§®‡§Ø‡§æ ‡§®‡§æ‡§Æ (New Child Name):</label>
                    <input type="text" id="newName" placeholder="Ex: Kr. Yuvraj Singh">
                    
                    <button onclick="addName()" class="tool-btn" style="background:#d4af37; color:#000;">‚ûï ‡§®‡§æ‡§Æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç (Add Name)</button>

                    <hr style="border-color:#555; margin: 20px 0;">

                    <h3>‡§ö‡§∞‡§£ 3: ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§ï‡•ã‡§°</h3>
                    <textarea id="outputHtml" readonly placeholder="‡§®‡§Ø‡§æ ‡§ï‡•ã‡§° ‡§Ø‡§π‡§æ‡§Å ‡§Ü‡§è‡§ó‡§æ..."></textarea>
                    <button onclick="copyOutput()" class="tool-btn copy-btn">‚úÖ ‡§ï‡•â‡§™‡•Ä ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ GitHub ‡§™‡§∞ ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç</button>
                </div>

                <div class="preview-panel">
                    <h3 style="color:#800000; border-bottom:1px solid #800000;">Live Preview</h3>
                    <div id="livePreview" class="tree">
                        <p style="color:#666; font-style:italic; padding:20px;">'Load Live Code' ‡§¨‡§ü‡§® ‡§¶‡§¨‡§æ‡§è‡§Ç...</p>
                    </div>
                </div>

            </div>
        </div>

        <div class="stats-box">
            <h4>üìä ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§µ‡§ø‡§ú‡§ø‡§ü‡§∞ ‡§ï‡§æ‡§â‡§Ç‡§ü‡§∞</h4>
            <div style="background:#fff; display:inline-block; padding:10px; border-radius:5px;">
                <a href="https://www.freecounterstat.com" title="page view counter"><img src="https://counter1.optistats.ovh/private/freecounterstat.php?c=brzhztc9x8c82arbz88kkwylmw659h6z" border="0" title="page view counter" alt="page view counter"></a>
            </div>
        </div>

    </div>

    <script>
        // 1. FETCH LIVE CODE (NEW FUNCTION)
        async function fetchLiveCode() {
            const btn = document.querySelector('button[onclick="fetchLiveCode()"]');
            const originalText = btn.innerHTML;
            btn.innerHTML = "‚è≥ Loading...";
            
            try {
                // ‡§ü‡§æ‡§á‡§Æ‡§∏‡•ç‡§ü‡•à‡§Æ‡•ç‡§™ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§´‡§æ‡§á‡§≤ ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§™‡•Å‡§∞‡§æ‡§®‡§æ (Cached) ‡§°‡•á‡§ü‡§æ ‡§® ‡§Ü‡§è
                const response = await fetch('vanshawali.html?v=' + new Date().getTime());
                
                if (!response.ok) {
                    throw new Error("vanshawali.html ‡§´‡§æ‡§á‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä! (File not found)");
                }

                const text = await response.text();
                document.getElementById('inputHtml').value = text;
                loadPreview(); // ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§™‡•ç‡§∞‡•Ä‡§µ‡•ç‡§Ø‡•Ç ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç
                
                alert("‚úÖ ‡§µ‡§Ç‡§∂‡§æ‡§µ‡§≤‡•Ä ‡§ï‡§æ ‡§ï‡•ã‡§° ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§≤‡•ã‡§° ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à!");
            } catch (err) {
                console.error(err);
                alert("‚ùå ‡§ó‡§≤‡§§‡•Ä: " + err.message + "\n(‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç: ‡§Ø‡§π ‡§´‡•Ä‡§ö‡§∞ ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§≤‡§æ‡§á‡§µ ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§Ø‡§æ ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§™‡§∞ ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡•á‡§ó‡§æ)");
            } finally {
                btn.innerHTML = originalText;
            }
        }

        // 2. PASTE FUNCTION
        async function pasteFromClipboard() {
            try {
                const text = await navigator.clipboard.readText();
                if (text) {
                    document.getElementById('inputHtml').value = text;
                    loadPreview();
                } else { alert("Clipboard empty!"); }
            } catch (err) { alert("Paste permission denied. Please press Ctrl+V manually."); }
        }

        // 3. LOAD PREVIEW
        function loadPreview() {
            const code = document.getElementById('inputHtml').value;
            const previewDiv = document.getElementById('livePreview');
            if(!code) { previewDiv.innerHTML = "Code Box is empty!"; return; }
            previewDiv.innerHTML = code; 
        }

        // 4. ADD NAME LOGIC (CORE)
        function addName() {
            const htmlContent = document.getElementById('inputHtml').value;
            const grandParent = document.getElementById('grandParentName').value.trim();
            const parent = document.getElementById('parentName').value.trim();
            const child = document.getElementById('newName').value.trim();

            if (!htmlContent || !grandParent || !parent || !child) {
                alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§≠‡•Ä ‡§®‡§æ‡§Æ ‡§≠‡§∞‡•á‡§Ç!"); return;
            }

            const parser = new DOMParser();
            const doc = parser.parseFromString(htmlContent, 'text/html');

            const allSpans = doc.querySelectorAll('.member-name');
            let parentFound = false;

            for (let span of allSpans) {
                if (span.textContent.trim() === parent) {
                    const parentCardDiv = span.closest('.member-card');
                    const parentLi = parentCardDiv.parentElement; 
                    
                    let childUl = parentLi.querySelector('ul');
                    if (!childUl) {
                        childUl = doc.createElement('ul');
                        parentLi.appendChild(childUl);
                    }

                    const newLi = doc.createElement('li');
                    newLi.innerHTML = `<div class="member-card"><span class="member-name">${child}</span></div>`;
                    
                    childUl.appendChild(newLi);
                    parentFound = true;
                    break; 
                }
            }

            if (parentFound) {
                const updatedHTML = doc.body.innerHTML; // Get mostly cleaned HTML
                document.getElementById('outputHtml').value = updatedHTML;
                document.getElementById('livePreview').innerHTML = updatedHTML;
                document.getElementById('inputHtml').value = updatedHTML; 
                alert("‚úÖ ‡§®‡§æ‡§Æ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ú‡•ã‡§°‡§º ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ! ‡§®‡•Ä‡§ö‡•á '‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§ï‡•ã‡§°' ‡§ï‡•â‡§™‡•Ä ‡§ï‡§∞‡•á‡§Ç‡•§");
            } else {
                alert("‚ùå ‡§™‡§ø‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ (Parent Name) ‡§ï‡•ã‡§° ‡§Æ‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§ ‡§µ‡§∞‡•ç‡§§‡§®‡•Ä (Spelling) ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç‡•§");
            }
        }

        // 5. COPY OUTPUT
        function copyOutput() {
            const copyText = document.getElementById("outputHtml");
            if (!copyText.value) { alert("‡§ï‡•ã‡§®‡•á ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§õ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à!"); return; }
            copyText.select();
            copyText.setSelectionRange(0, 99999); 
            navigator.clipboard.writeText(copyText.value);
            
            // GitHub Open in New Tab
            window.open('https://github.com/kasumalgarh/kasumalgarh.github.io/edit/main/vanshawali.html', '_blank');
        }
    </script>

</body>
</html>